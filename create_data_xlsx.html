<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Generar data.xlsx desde ejemplos</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
</head>
<body>
  <h2>Generar data.xlsx desde CSV de ejemplo</h2>
  <p>Pulsa el botón para generar y descargar <strong>data.xlsx</strong> (hojas: catalog, structure).</p>
  <button id="gen">Generar data.xlsx</button>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    document.getElementById('gen').addEventListener('click', () => {
      const catalogCsv = `Código,Plan,Valor,Promo1,Meses1,Promo2,Meses2,Detalles,Section,Subsection,ExtraFor,Active
T001,Trío 100Mb,50000,30000,6,40000,3,"Fibra 100 + TV básica",Hogar,trio,,TRUE
DT01,Fibra+TV 1,60000,40000,6,50000,3,"Fibra + TV paquete",Hogar,duo,,TRUE
DF01,Fibra+Fijo 1,55000,35000,6,45000,3,"Fibra + Fijo",Hogar,duo,,TRUE
F01,Fibra 100Mb,45000,30000,6,40000,3,"Fibra 100Mb",Hogar,uno,,TRUE
NM01,Nuevo Multi 1,20000,10000,6,15000,3,"Línea móvil 5GB",Movil,nuevo,,TRUE
NM02,Nuevo Multi 2,30000,20000,6,25000,3,"Línea móvil 10GB",Movil,nuevo,,TRUE
NM02S,Nuevo Multi 2 - Extra,10000,5000,3,8000,2,"Extra asociado a NM02",Movil,nuevo,NM02,TRUE
CM01,Cartera Multi 1,15000,10000,6,12000,3,"Línea cartera 4GB",Movil,cartera,,TRUE
CM02,Cartera Multi 2,18000,12000,6,14000,3,"Línea cartera 6GB",Movil,cartera,,TRUE
CM02S,Cartera Multi 2 - Extra,9000,5000,3,7000,2,"Extra asociado a CM02",Movil,cartera,CM02,TRUE
`;
      const structureCsv = `Section,Subsection,ComponentType,Prefixes,ToggleOptions,MultiPrefixes,MaxAdditional,ExtraMapping
Hogar,trio,trio,T,, ,0,
Hogar,duo,duo,,fibra_tv:DT,fibra_tv:DT,0,
Hogar,uno,uno,,fibra:F,tv:TV,fijo:FI,0,
Movil,nuevo,movil_group,,"","multi:NM,datos:ND,voz:NV",4,"NM02:NM02S;NM03:NM03S"
Movil,cartera,movil_group,,"","multi:CM,datos:CD,voz:CV",4,"CM02:CM02S;CM03:CM03S"
`;
      const wb = XLSX.utils.book_new();
      const ws1 = XLSX.utils.csv_to_sheet(catalogCsv);
      const ws2 = XLSX.utils.csv_to_sheet(structureCsv);
      XLSX.utils.book_append_sheet(wb, ws1, 'catalog');
      XLSX.utils.book_append_sheet(wb, ws2, 'structure');
      const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
      const blob = new Blob([wbout], { type: 'application/octet-stream' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'data.xlsx';
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>